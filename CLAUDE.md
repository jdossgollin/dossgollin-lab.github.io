# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Overview

This is a Quarto-based website for the Doss-Gollin Research Group at Rice University.
The site is automatically deployed to GitHub Pages via GitHub Actions when changes are pushed to the `master` branch.
Directly editing the site is prohibited, so all changes must be made by forking, pushing, and then opening a pull request.

## Build Commands

```bash
# Preview site locally (port 4200)
quarto preview

# Build site
quarto render
```

## Repository Structure

- **bibliography/**: Git submodule linked to `jdossgollin/my-papers`. Contains BibTeX files and auto-generated publication QMD files. Update with:

  ```bash
  git submodule update --remote --recursive
  ```

- **people/**: Group member pages organized by role (pi/, grad-students/, grad-students-coadvised/, alumni/, undergrad-students/)
- **posts/**: News and announcements organized by year (YYYY/)
- **_assets/**: Images, theme files, and references

## Key Configurations

- **_quarto.yml**: Main site configuration (navbar, theme, bibliography settings)
- **_variables.yml**: Reusable site variables

## Content Patterns

### People Pages

Located in `people/<role>/<name>.qmd`.
Required frontmatter:

```yaml
---
title: "Full Name"
sortby: "LastName, FirstName"  # Controls display order
started: "Season YYYY"
ended: "Current" or "YYYY"
position: "Role Title"  # For alumni table
about:
    id: person-profile
    image: "../../_assets/img/people/filename.jpg" # A **square** image in _assets/img/people/
    template: trestles  # or jolla for simple profiles; see https://quarto.org/docs/websites/website-about.html
    links:
        - icon: github
          text: Github
          href: https://github.com/username
---
```

### Posts

Located in `posts/YYYY/YYYY-MM-DD-slug.qmd`.
Use categories field for grouping (e.g., `categories: Publications`).
Posts can reference bibliography with `bibliography: ../../bibliography/my-papers.bib`.

### Publications

Publication QMD files in `bibliography/publications/` are auto-generated by `bibliography/bibtex_to_qmd.py` from `bibliography/my-papers.bib`.
Do not edit these directly; update the BibTeX source instead.

If a publication is showing up without a thumbnail image in the rendered or previewed website, it's because there is no corresponding image in the bibliography repository.
In the bibliography repository, add a thumbnail to `_assets/img/pubs/`; the citekey should be the same as the bibtex citekey, but with the `:` before the year replaced with an underscore `_`.

## Writing Style

When editing Markdown or Quarto files, use one sentence per line to produce cleaner git diffs.

## Deployment

GitHub Actions workflow (`.github/workflows/publish-quarto.yml`) renders and publishes to `gh-pages` branch on push to `master`. The workflow also updates the bibliography submodule before rendering.
